

<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>KI Trading Pro</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{background:#0f1115;color:#e7fdf9;font-family:system-ui;margin:0;padding:15px}
h1{text-align:center}
select,button{width:100%;padding:14px;margin-top:10px;border-radius:12px;border:1px solid #00ffaa;background:#141822;color:white}
button:disabled{opacity:.6}
.box{background:#141822;border-radius:12px;padding:10px;margin-top:10px}
.status{text-align:center;margin-top:10px;font-weight:bold}
canvas{margin-top:15px;background:#111;border-radius:12px}
</style>
</head>
<body>

<h1>KI Trading Pro</h1>

<select id="stock">
<option value="AAPL">AAPL</option>
<option value="MSFT">MSFT</option>
<option value="NVDA">NVDA</option>
<option value="ABB">ABB</option>
<option value="SAP">SAP</option>
<option value="ASML">ASML</option>
<option value="NESN">NESN</option>
</select>

<select id="horizon">
<option value="1">1 Tag</option>
<option value="22">1 Monat</option>
<option value="66">3 Monate</option>
</select>

<button id="analyze">Analyse starten</button>

<div class="status" id="status">Bereit</div>

<div class="box" id="results">
Aktueller Wert: –<br>
Prognose: –<br>
Confidence: –
</div>

<canvas id="chart"></canvas>

<script>
const btn=document.getElementById("analyze");
const statusEl=document.getElementById("status");
const resBox=document.getElementById("results");
let chart;

btn.onclick=async()=>{
  btn.disabled=true;
  statusEl.textContent="Lade Marktdaten...";

  try{
    const symbol=document.getElementById("stock").value;
    const days=parseInt(document.getElementById("horizon").value);

    const r=await fetch(`/api/stock?symbol=${symbol}`);
    const data=await r.json();

    if(!data.success) throw "NO DATA";

    const prices=data.prices;

    if(chart) chart.destroy();
    chart=new Chart(document.getElementById("chart"),{
      type:"line",
      data:{labels:prices.map((_,i)=>i),
      datasets:[{data:prices,borderColor:"#00ffaa",tension:.3}]},
      options:{plugins:{legend:{display:false}}}
    });

    statusEl.textContent="Berechne KI Prognose...";

    const p=await fetch("/api/predict",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({prices,days})
    });

    const pred=await p.json();

    resBox.innerHTML=`
      Aktueller Wert: ${prices.at(-1).toFixed(2)}<br>
      Prognose: ${pred.predicted.toFixed(2)}<br>
      Confidence: ${pred.confidence}%
    `;

    statusEl.textContent="Analyse abgeschlossen ✅";
  }catch{
    statusEl.textContent="⚠️ Keine Marktdaten";
  }

  btn.disabled=false;
};
</script>

</body>
</html>
