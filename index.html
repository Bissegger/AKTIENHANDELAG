<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>YANNIC KÃ–BI AKTIEN HANDEL AG â€“ KI Analyse</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{background:#121212;color:#d8f3ef;font-family:Arial;margin:0;padding:16px}
h1{text-align:center}
.subtitle{text-align:center;color:#9fd3cc;font-size:0.85rem}
.controls{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:12px 0}
select,button{background:#1b1b1b;color:#d8f3ef;border:1px solid #00ccaa;padding:6px 12px;border-radius:6px;cursor:pointer}
button:hover{background:#00ccaa;color:#000}
.status{text-align:center;font-weight:bold;margin:10px 0}
canvas{max-width:1200px;margin:20px auto;display:block;background:#1a1a1a;border-radius:8px;padding:10px}
table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{border:1px solid #00ccaa;padding:6px;text-align:center}
.buy{color:#00ff88;font-weight:bold}
.sell{color:#ff6666;font-weight:bold}
.hold{color:#ffaa55;font-weight:bold}
.newspos{color:#00ff88}
.newsneu{color:#ffaa55}
.newsneg{color:#ff6666}
.footer{text-align:center;font-size:0.8rem;color:#9fcfc8;margin-top:14px}
.tabbox{max-width:1200px;margin:10px auto;background:#1a1a1a;border:1px solid #00ccaa;padding:10px;border-radius:6px}
</style>
</head>

<body>

<h1>YANNIC KÃ–BI AKTIEN HANDEL AG</h1>
<div class="subtitle">Echte Aktienanalyse mit KI & News</div>

<div class="controls">
<select id="stock"></select>
<select id="days">
<option value="30">1 Monat</option>
<option value="60">2 Monate</option>
<option value="90" selected>3 Monate</option>
</select>
</div>

<div class="controls">
<button onclick="toggleKI()" id="kiBtn">ðŸ§  KI: AUS</button>
<button onclick="analyze()">Analyse starten</button>
<button onclick="openYahoo()">Yahoo Finance</button>
</div>

<div class="status" id="status">System bereit</div>

<canvas id="chart"></canvas>

<table>
<thead>
<tr>
<th>Aktueller Kurs (CHF)</th>
<th>Prognose (CHF)</th>
<th>Signal</th>
<th>StabilitÃ¤t</th>
</tr>
</thead>
<tbody id="result"></tbody>
</table>

<div class="tabbox">
<h3>ðŸ“° News-Analyse</h3>
<div id="news">â€“</div>
</div>

<div class="footer">
Â© 2026 YANNIC KÃ–BI AKTIEN HANDEL AG â€“ Keine Anlageberatung
</div>

<script>
"use strict";

/* =================== CONFIG =================== */
const API_KEY="d5ohqjhr01qjast6qrjgd5ohqjhr01qjast6qrk0";
let KI_AKTIV=false;

/* =================== AKTIEN =================== */
const STOCKS=[
["AAPL","Apple Inc."],["MSFT","Microsoft Corp."],["NVDA","NVIDIA Corp."],
["TSLA","Tesla Inc."],["AMZN","Amazon.com Inc."],["GOOGL","Alphabet Inc."],
["META","Meta Platforms Inc."],["SAP","SAP SE"],["NESN.SW","NestlÃ© SA"]
];

const stockSel=document.getElementById("stock");
STOCKS.forEach(s=>{
  const o=document.createElement("option");
  o.value=s[0]; o.textContent=`${s[0]} â€“ ${s[1]}`;
  stockSel.appendChild(o);
});

/* =================== KI TOGGLE =================== */
function toggleKI(){
  KI_AKTIV=!KI_AKTIV;
  document.getElementById("kiBtn").textContent="ðŸ§  KI: "+(KI_AKTIV?"EIN":"AUS");
}

/* =================== CHART =================== */
let chart;
function draw(prices,forecast){
  if(chart) chart.destroy();
  chart=new Chart(document.getElementById("chart"),{
    type:"line",
    data:{
      labels:[...prices.map((_,i)=>"T"+(i+1)),...forecast.map((_,i)=>"F"+(i+1))],
      datasets:[
        {label:"Kurs",data:[...prices,...Array(forecast.length).fill(null)],borderColor:"#00ccaa"},
        {label:"Prognose",data:[...Array(prices.length).fill(null),...forecast],borderColor:"#ffaa55"}
      ]
    }
  });
}

/* =================== DATEN =================== */
async function fetchPrices(symbol,days){
  const now=Math.floor(Date.now()/1000);
  const from=now-days*86400;
  const r=await fetch(`https://finnhub.io/api/v1/stock/candle?symbol=${symbol}&resolution=D&from=${from}&to=${now}&token=${API_KEY}`);
  const d=await r.json();
  if(d.s==="ok"){
    localStorage.setItem("CACHE_"+symbol,JSON.stringify(d.c));
    return d.c;
  }
  const c=localStorage.getItem("CACHE_"+symbol);
  if(c) return JSON.parse(c);
  throw "Keine Marktdaten";
}

/* =================== PROGNOSE =================== */
function forecastPrices(prices,n){
  const last=prices.at(-1),prev=prices.at(-2)||last;
  let trend=last-prev;
  if(KI_AKTIV) trend*=1.4;
  return Array.from({length:n},(_,i)=>last+trend*(i+1));
}

/* =================== NEWS =================== */
async function loadNews(symbol){
  try{
    const r=await fetch(`https://finnhub.io/api/v1/company-news?symbol=${symbol}&from=2024-01-01&to=2026-12-31&token=${API_KEY}`);
    const d=await r.json();
    if(!d.length) return "Keine aktuellen News";

    const n=d[0];
    let impact="newsneu",text="Neutral";
    if(n.headline.match(/beat|record|growth|surge/i)){impact="newspos";text="Positiv";}
    if(n.headline.match(/loss|fall|lawsuit|drop/i)){impact="newsneg";text="Negativ";}

    return `<span class="${impact}"><b>${text}</b></span><br>${n.headline}`;
  }catch{
    return "News nicht verfÃ¼gbar";
  }
}

/* =================== ANALYSE =================== */
async function analyze(){
  const status=document.getElementById("status");
  status.textContent="Analyse lÃ¤uftâ€¦";

  try{
    const symbol=stockSel.value;
    const days=parseInt(document.getElementById("days").value);
    const pricesUSD=await fetchPrices(symbol,days);
    const prices=pricesUSD.map(p=>p*0.93);

    const forecast=forecastPrices(prices,7);
    draw(prices,forecast);

    const last=prices.at(-1);
    const pred=forecast.at(-1);
    const diff=(pred-last)/last;

    const signal=diff>0.06?"KAUFEN":diff<-0.06?"VERKAUFEN":"HALTEN";
    const cls=signal==="KAUFEN"?"buy":signal==="VERKAUFEN"?"sell":"hold";
    const stab=Math.abs(diff)<0.05?"Stabil":"Volatil";

    document.getElementById("result").innerHTML=`
    <tr>
      <td>${last.toFixed(2)}</td>
      <td>${pred.toFixed(2)}</td>
      <td class="${cls}">${signal}</td>
      <td>${stab}</td>
    </tr>`;

    document.getElementById("news").innerHTML=await loadNews(symbol);
    status.textContent="Analyse abgeschlossen";
  }catch(e){
    status.textContent="Fehler: "+e;
  }
}

function openYahoo(){
  window.open("https://finance.yahoo.com/quote/"+stockSel.value,"_blank");
}
</script>

</body>
</html>
