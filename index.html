<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>YANNIC KÃ–BI AKTIEN HANDEL AG â€“ Mobile KI Analyse</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#121212;
  --card:#1a1a1a;
  --accent:#00ccaa;
  --text:#d8f3ef;
}

body{
  background:var(--bg);
  color:var(--text);
  font-family:Arial,Helvetica,sans-serif;
  margin:0;
  padding:12px;
}

h1{
  text-align:center;
  font-size:1.3rem;
  margin:6px 0;
}

.subtitle{
  text-align:center;
  font-size:.8rem;
  color:#9fd3cc;
  margin-bottom:10px;
}

.controls{
  display:flex;
  flex-direction:column;
  gap:8px;
  margin:10px 0;
}

select,button{
  width:100%;
  padding:10px;
  font-size:1rem;
  background:#1b1b1b;
  color:var(--text);
  border:1px solid var(--accent);
  border-radius:8px;
}

button{
  font-weight:bold;
}

button:active{
  background:var(--accent);
  color:#000;
}

.status{
  text-align:center;
  font-size:.85rem;
  margin:4px 0;
}

canvas{
  width:100%!important;
  height:260px!important;
  background:var(--card);
  border-radius:10px;
  padding:6px;
}

.table-wrap{
  overflow-x:auto;
  margin-top:10px;
}

table{
  width:100%;
  min-width:520px;
  border-collapse:collapse;
}

th,td{
  border:1px solid var(--accent);
  padding:6px;
  text-align:center;
  font-size:.85rem;
}

.buy{color:#00ff88;font-weight:bold}
.sell{color:#ff6666;font-weight:bold}
.hold{color:#ffaa55;font-weight:bold}

.footer{
  text-align:center;
  font-size:.75rem;
  color:#9fcfc8;
  margin-top:12px;
}
</style>
</head>

<body>

<h1>YANNIC KÃ–BI AKTIEN HANDEL AG</h1>
<div class="subtitle">Mobile KI-Analyse Â· Echtzeitdaten Â· Stabil</div>

<div class="controls">
  <select id="stock"></select>
  <select id="days">
    <option value="30">1 Monat</option>
    <option value="60">2 Monate</option>
    <option value="90" selected>3 Monate</option>
  </select>
  <button id="kiBtn">ðŸ§  KI: EIN</button>
  <button id="analyzeBtn">ðŸ“Š Analyse starten</button>
</div>

<div class="status" id="market"></div>
<div class="status" id="status">System bereit</div>

<canvas id="chart"></canvas>

<div class="table-wrap">
<table>
<thead>
<tr>
  <th>Kurs (CHF)</th>
  <th>Prognose</th>
  <th>Signal</th>
  <th>StabilitÃ¤t</th>
  <th>Pattern</th>
</tr>
</thead>
<tbody id="result"></tbody>
</table>
</div>

<div class="footer">Â© 2026 â€“ Keine Anlageberatung</div>

<script>
"use strict";

/* ===== BASIS ===== */
const API_KEY="d5ohqjhr01qjast6qrjgd5ohqjhr01qjast6qrk0";
let KI=true, chart=null;

/* ===== AKTIEN ===== */
const STOCKS=[
["AAPL","Apple Inc."],["MSFT","Microsoft"],["NVDA","NVIDIA"],
["AMZN","Amazon"],["TSLA","Tesla"],["GOOGL","Alphabet"],
["META","Meta"],["NFLX","Netflix"],
["NESN.SW","NestlÃ©"],["ROG.SW","Roche"],["NOVN.SW","Novartis"]
];

const stockSel=document.getElementById("stock");
STOCKS.forEach(s=>{
  const o=document.createElement("option");
  o.value=s[0];
  o.textContent=`${s[0]} â€“ ${s[1]}`;
  stockSel.appendChild(o);
});

/* ===== BUTTONS ===== */
kiBtn.onclick=()=>{
  KI=!KI;
  kiBtn.textContent="ðŸ§  KI: "+(KI?"EIN":"AUS");
};

analyzeBtn.onclick=()=>analyze();

/* ===== MARKET STATUS ===== */
function updateMarket(){
  const now=new Date();
  const d=now.getDay();
  market.textContent=
    (d===0||d===6)
    ?"ðŸ”´ BÃ¶rse geschlossen (Wochenende)"
    :"ðŸŸ¢ Marktstatus geprÃ¼ft";
}

/* ===== DATA ===== */
async function fetchOHLC(symbol){
  const now=Math.floor(Date.now()/1000);
  const from=now-300*86400;
  try{
    const r=await fetch(
      `https://finnhub.io/api/v1/stock/candle?symbol=${symbol}&resolution=D&from=${from}&to=${now}&token=${API_KEY}`
    );
    const d=await r.json();
    if(d.s==="ok"&&d.c?.length){
      localStorage.setItem("CACHE_"+symbol,JSON.stringify(d));
      return d;
    }
  }catch{}
  const cache=localStorage.getItem("CACHE_"+symbol);
  return cache?JSON.parse(cache):null;
}

/* ===== PATTERN ===== */
function pattern(d){
  const i=d.c.length-1;
  let score=0,p=[];
  if(i<1) return {score,p:["â€“"]};
  const body=Math.abs(d.c[i]-d.o[i]);
  const range=d.h[i]-d.l[i];
  if(body<range*0.1){p.push("Doji");score++;}
  if(d.c[i]>d.o[i]&&d.c[i-1]<d.o[i-1]){p.push("Bullish Engulfing");score+=3;}
  if(d.o[i]>d.c[i]&&d.c[i-1]>d.o[i-1]){p.push("Bearish Engulfing");score-=3;}
  return {score,p};
}

/* ===== CHART ===== */
function draw(prices,forecast){
  if(chart) chart.destroy();
  chart=new Chart(chartEl,{
    type:"line",
    data:{
      labels:[...prices.map((_,i)=>i+1),...forecast.map((_,i)=>"F"+(i+1))],
      datasets:[
        {label:"Kurs",data:[...prices,...Array(forecast.length).fill(null)]},
        {label:"Prognose",data:[...Array(prices.length).fill(null),...forecast]}
      ]
    },
    options:{responsive:true,maintainAspectRatio:false}
  });
}

/* ===== ANALYSE ===== */
async function analyze(){
  status.textContent="Analyse lÃ¤uftâ€¦";
  updateMarket();

  const d=await fetchOHLC(stockSel.value);
  if(!d){status.textContent="Keine Marktdaten";return;}

  const prices=d.c.slice(-30).map(p=>p*0.93);
  const last=prices.at(-1);
  const r=pattern(d);

  let factor=0.002;
  if(r.score>2) factor=0.008;
  if(r.score<0) factor=-0.006;
  if(!KI) factor=0;

  const forecast=[1,2,3,4,5].map(i=>last*(1+factor*i));
  draw(prices,forecast);

  const diff=(forecast.at(-1)-last)/last;
  const signal=diff>0.05?"KAUFEN":diff<-0.05?"VERKAUFEN":"HALTEN";
  const cls=signal==="KAUFEN"?"buy":signal==="VERKAUFEN"?"sell":"hold";

  result.innerHTML=`
  <tr>
    <td>${last.toFixed(2)}</td>
    <td>${forecast.at(-1).toFixed(2)}</td>
    <td class="${cls}">${signal}</td>
    <td>${Math.max(20,100-Math.abs(diff)*600).toFixed(0)}/100</td>
    <td>${r.p.join(", ")}</td>
  </tr>`;

  status.textContent="Analyse abgeschlossen";
}

updateMarket();
</script>

</body>
</html>
